<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo da Corrida - RF Driver</title>

<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="theme/theme.css">
<link rel="stylesheet" href="theme/layout.css">
<link rel="stylesheet" href="theme/components.css">

<style>
.top-actions{
  display:flex;
  gap:10px;
  margin-bottom:12px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:12px;
}
.total{
  font-size:22px;
  font-weight:800;
  text-align:right;
}
.muted{color:var(--muted)}
</style>
</head>

<body>

<div class="app">

  <!-- AÃ‡Ã•ES TOPO -->
  <div class="top-actions">
    <button class="btn btn-secondary" onclick="App.go('origem.html')">ğŸ”„ Nova cotaÃ§Ã£o</button>
    <button class="btn btn-secondary" onclick="App.go('index.html')">ğŸ  InÃ­cio</button>
  </div>

  <h1>TABELA DE PREÃ‡OS<br>RF DRIVER</h1>

  <div class="card">
    <p id="rota"></p>
    <p id="horaAtual" class="muted"></p>
  </div>

  <div class="card">
    <p id="valorBaseOriginal"></p>
    <p id="valorBaseCalculado"></p>
  </div>

  <h3>Resultado</h3>
  <div class="card">
    <p class="total" id="total"></p>
    <p id="restante"></p>
    <button class="btn btn-primary" onclick="enviarWhatsApp()">ğŸ“² Enviar no WhatsApp</button>
  </div>

</div>

<script src="core/global.js"></script>
<script src="js/calculo.js"></script>

<script>
const { origem, destino, valorBase } = App.state;
if (!origem || !destino) App.go("index.html");

rota.textContent = `ğŸš— ${origem} â†’ ${destino}`;
horaAtual.textContent = new Date().toLocaleString();

const r = Calculo.calcularTotal({ valorBase, taxas: {} });

valorBaseOriginal.textContent = `Valor base: R$ ${r.valorBaseOriginal.toFixed(2)}`;
total.textContent = `Total: R$ ${r.totalFinal.toFixed(2)}`;
restante.textContent = `A receber: R$ ${r.valorRestante.toFixed(2)}`;

window.__mensagemWhats = `
ğŸš— *RF Driver*
ğŸ“ Origem: ${origem}
ğŸ“ Destino: ${destino}

ğŸ’µ Total: R$ ${r.totalFinal.toFixed(2)}
`;

function enviarWhatsApp(){
  window.open(
    `https://wa.me/?text=${encodeURIComponent(window.__mensagemWhats)}`,
    "_blank"
  );
}
</script>

</body>
</html>
