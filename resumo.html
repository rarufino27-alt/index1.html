<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo â€“ RF Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="theme/theme.css">
<link rel="stylesheet" href="theme/layout.css">
<link rel="stylesheet" href="theme/components.css">

<style>
body{
  min-height:100vh;
  background:radial-gradient(circle at top,#1a1a1a 0%,#000 60%);
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.container{
  width:100%;
  max-width:620px;
  padding:30px;
  background:linear-gradient(145deg,rgba(20,20,20,.95),rgba(0,0,0,.85));
  border-radius:22px;
  box-shadow:0 0 40px rgba(255,215,120,.25);
}
h1{
  text-align:center;
  font-size:2rem;
  background:linear-gradient(90deg,#d4af37,#f5e28c,#c9a227);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.section{margin-top:20px}
.card{
  border:1px solid rgba(255,215,120,.2);
  border-radius:14px;
  padding:14px;
  margin-bottom:12px;
}
.card.highlight{
  border-color:#f5c542;
  background:rgba(245,197,66,.08);
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:10px;
}
.total{
  font-size:1.6rem;
  font-weight:bold;
  text-align:center;
  margin-top:10px;
}
.small{font-size:.85rem;color:#bbb}
.hidden{display:none}
input[type="number"]{
  width:100%;
  margin-top:6px;
  padding:8px;
  border-radius:8px;
  border:1px solid #444;
  background:#000;
  color:#fff;
}
</style>
</head>

<body>

<div class="container">

<h1>RF DRIVER</h1>

<div class="card">
  <p><strong>Origem:</strong> <span id="origemTxt"></span></p>
  <p><strong>Destino:</strong> <span id="destinoTxt"></span></p>
  <p><strong>Valor base:</strong> R$ <span id="valorBaseTxt"></span></p>
</div>

<div class="section">
  <h3>Taxas adicionais</h3>

  <div class="grid">

    <label class="card"><input type="checkbox" id="feira"> ğŸ›ï¸ SaÃ­da de feira</label>
    <label class="card"><input type="checkbox" id="praia"> â›±ï¸ SaÃ­da de praias</label>
    <label class="card"><input type="checkbox" id="excesso"> ğŸ‘¥ Excesso de pessoas</label>

    <div class="card">
      <strong>ğŸ¶ Animal</strong>
      <select id="animal">
        <option value="0">Nenhum</option>
        <option value="5">Pequeno</option>
        <option value="7">MÃ©dio</option>
        <option value="10">Grande</option>
      </select>
      <label class="small">
        <input type="checkbox" id="viagemLonga"> Viagem longa (+R$ 20)
      </label>
    </div>

    <label class="card"><input type="checkbox" id="desvioSimples"> ğŸ›£ï¸ Desvio simples</label>

    <div class="card" id="cardEspera">
      <label>
        <input type="checkbox" id="desvioEspera">
        ğŸ›£ï¸â³ Desvio com espera
      </label>
      <input type="number" id="minutosEspera" min="0" placeholder="Minutos de espera">
      <div class="small">R$ 3,00 a cada 5 minutos (a partir de 5 min)</div>
    </div>

  </div>
</div>

<div class="card hidden" id="detalhamentoBox">
  <strong>âœğŸ½ Detalhamento</strong>
  <ul id="detalhamento"></ul>
</div>

<div class="card">
  <div class="total">ğŸ’¸ Total: R$ <span id="totalTxt"></span></div>
</div>

<button class="btn btn-primary" id="btnWhats">ğŸ“² Enviar no WhatsApp</button>
<button class="btn btn-secondary" onclick="App.go('destino.html')">â—€ Voltar</button>

</div>

<script src="core/global.js"></script>

<script>
const origem = App.get("origem");
const destino = App.get("destino");
const base = Number(App.get("valorBase") || 0);

if(!origem || !destino || base <= 0) App.go("index.html");

origemTxt.textContent = origem;
destinoTxt.textContent = destino;
valorBaseTxt.textContent = base.toFixed(2);

function calcularEspera(min){
  if(min < 5) return 0;
  return Math.floor(min / 5) * 3;
}

function calcular(){
  let total = base;
  let detalhes = [];

  if(feira.checked){ total+=5; detalhes.push("ğŸ›ï¸ SaÃ­da de feira: R$ 5.00"); }
  if(praia.checked){ total+=10; detalhes.push("â›±ï¸ SaÃ­da de praias: R$ 10.00"); }
  if(excesso.checked){ total+=25; detalhes.push("ğŸ‘¥ Excesso de pessoas: R$ 25.00"); }

  let animalValor = Number(animal.value);
  if(viagemLonga.checked){
    total+=20;
    detalhes.push("ğŸ¶ Animal (viagem longa): R$ 20.00");
  }else if(animalValor>0){
    total+=animalValor;
    detalhes.push(`ğŸ¶ Animal: R$ ${animalValor.toFixed(2)}`);
  }

  if(desvioSimples.checked){
    total+=5;
    detalhes.push("ğŸ›£ï¸ Desvio simples: R$ 5.00");
  }

  if(desvioEspera.checked){
    const min = Number(minutosEspera.value || 0);
    const valor = calcularEspera(min);
    total += valor;
    detalhes.push(`ğŸ›£ï¸â³ Desvio com espera (${min} min): R$ ${valor.toFixed(2)}`);
  }

  detalhamento.innerHTML = detalhes.map(d=>`<li>${d}</li>`).join("");
  detalhamentoBox.classList.toggle("hidden", detalhes.length===0);

  totalTxt.textContent = total.toFixed(2);
  return { total, detalhes };
}

document.querySelectorAll("input,select").forEach(el=>{
  el.addEventListener("change",()=>{
    el.closest(".card")?.classList.toggle(
      "highlight",
      el.checked || (el.type==="number" && el.value>0) || el.value>0
    );
    calcular();
  });
});

btnWhats.onclick=()=>{
  const r = calcular();
  let msg = `ğŸš– RF Driver\n\nğŸ“Œ Origem: ${origem}\nğŸ›« Destino: ${destino}\nğŸ’° Total: R$ ${r.total.toFixed(2)}`;
  if(r.detalhes.length){
    msg+=`\n\nâœğŸ½ Detalhamento\n`+r.detalhes.join("\n");
  }
  msg+=`\n\nğŸ’¸ Total: R$ ${r.total.toFixed(2)}`;
  window.open("https://wa.me/?text="+encodeURIComponent(msg));
};

calcular();
</script>

</body>
</html>