<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo - RF Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="theme/theme.css">
<link rel="stylesheet" href="theme/layout.css">
<link rel="stylesheet" href="theme/components.css">

<style>
body{
  min-height:100vh;
  background:radial-gradient(circle at top, #1a1a1a 0%, #000 60%);
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.container{
  width:100%;
  max-width:620px;
  padding:30px;
  background:linear-gradient(145deg, rgba(20,20,20,.95), rgba(0,0,0,.85));
  border-radius:22px;
  box-shadow:0 0 40px rgba(255,215,120,.25);
}
h1{
  text-align:center;
  background:linear-gradient(90deg,#d4af37,#f5e28c,#c9a227);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.section{margin-top:20px}
.section h3{margin-bottom:10px;color:#f5c542}
.line{display:flex;justify-content:space-between;margin:6px 0}
.total{
  margin-top:20px;
  font-size:1.4rem;
  font-weight:700;
  text-align:center;
}
select,input{
  width:100%;
  padding:10px;
  border-radius:10px;
  background:#111;
  color:#fff;
  border:1px solid rgba(255,215,120,.25);
}
button{
  margin-top:15px;
}
</style>
</head>

<body>

<div class="container">
<h1>Resumo da Corrida</h1>

<div class="section">
  <div class="line"><span>Origem</span><span id="origem"></span></div>
  <div class="line"><span>Destino</span><span id="destino"></span></div>
</div>

<div class="section">
<h3>Tipo de Viagem</h3>
<select id="tipoViagem">
  <option value="normal">Nenhum</option>
  <option value="bate">Bate e volta</option>
  <option value="ida">Ida e volta</option>
  <option value="idaespera">Ida e volta com espera</option>
</select>
</div>

<div class="section">
<h3>Adicionais</h3>

<label><input type="checkbox" id="excesso"> Excesso de pessoas</label><br><br>

<label>Animal</label>
<select id="animal">
  <option value="0">Nenhum</option>
  <option value="5">Pequeno</option>
  <option value="7">M√©dio</option>
  <option value="10">Grande</option>
  <option value="20">Viagem longa</option>
</select>

<br><br>
<label>Desvio com espera (min)</label>
<input type="number" id="espera" min="0" placeholder="Minutos">
</div>

<div class="section" id="detalhamento"></div>

<div class="total" id="total"></div>

<button class="btn btn-primary" onclick="enviarWhats()">Enviar WhatsApp</button>
</div>

<script src="core/global.js"></script>

<script>
const origem = App.get("origem");
const destino = App.get("destino");
let base = App.get("valorBase");

document.getElementById("origem").textContent = origem;
document.getElementById("destino").textContent = destino;

function horarioNoturno(){
  const h = new Date();
  const min = h.getHours()*60 + h.getMinutes();
  return (min >= 1350 || min <= 299);
}

function calcular(){
  let valor = base;
  let detalhes = [];

  // Tipo viagem
  const tipo = tipoViagem.value;
  if(tipo==="bate"){ valor*=2; detalhes.push("üîÅ Bate e volta"); }
  if(tipo==="ida"){ valor*=1.8; detalhes.push("üîÅ Ida e volta"); }
  if(tipo==="idaespera"){ valor=(valor*2)*1.1; detalhes.push("‚è≥ Ida e volta com espera"); }

  // Excesso pessoas
  if(excesso.checked){
    let v = valor < 30 ? 5 : valor*0.5;
    valor += v;
    detalhes.push(`üë• Excesso de pessoas: R$ ${v.toFixed(2)}`);
  }

  // Animal
  let a = Number(animal.value);
  if(a>0){ valor+=a; detalhes.push(`üê∂ Transporte animal: R$ ${a.toFixed(2)}`); }

  // Espera
  let m = Number(espera.value||0);
  if(m>=5){
    let blocos = Math.floor(m/5);
    let v = blocos*3;
    valor+=v;
    detalhes.push(`üõ£Ô∏è‚è≥ Espera ${m} min: R$ ${v.toFixed(2)}`);
  }

  // Noturno
  if(horarioNoturno()){
    let v = valor < 30 ? 5 : valor*0.35;
    valor+=v;
    detalhes.push(`üåô Adicional noturno: R$ ${v.toFixed(2)}`);
  }

  detalhamento.innerHTML = detalhes.length
    ? "<h3>Detalhamento</h3>" + detalhes.map(d=>`<div class="line"><span>${d}</span></div>`).join("")
    : "";

  total.textContent = `Total: R$ ${valor.toFixed(2)}`;
  App.set("total", valor);
}

document.querySelectorAll("select,input").forEach(e=>e.addEventListener("change", calcular));
calcular();

function enviarWhats(){
  const msg = encodeURIComponent(`üöñ RF Driver\n\nüìå Origem: ${origem}\nüõ´ Destino: ${destino}\nüí∞ Total: R$ ${App.get("total").toFixed(2)}`);
  window.open(`https://wa.me/?text=${msg}`);
}
</script>

</body>
</html>