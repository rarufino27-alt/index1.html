<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo â€“ RF Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="theme/theme.css">
<link rel="stylesheet" href="theme/layout.css">
<link rel="stylesheet" href="theme/components.css">

<style>
body{
  min-height:100vh;
  background:radial-gradient(circle at top, #1a1a1a 0%, #000 60%);
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.container{
  width:100%;
  max-width:640px;
  padding:30px;
  background:linear-gradient(145deg, rgba(20,20,20,.95), rgba(0,0,0,.85));
  border-radius:22px;
  box-shadow:0 0 40px rgba(255,215,120,.25);
}
h2{
  text-align:center;
  margin-bottom:6px;
  background:linear-gradient(90deg,#d4af37,#f5e28c,#c9a227);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.viagem{
  text-align:center;
  font-size:.9rem;
  color:#ddd;
  margin-bottom:18px;
}
.quadrante{
  border:1px solid rgba(255,215,120,.25);
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
}
.quadrante h3{
  font-size:.95rem;
  margin-bottom:8px;
  color:#f5c542;
}
select,input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  background:#111;
  color:#fff;
}
label{font-size:.85rem}
.total{
  text-align:center;
  font-size:1.5rem;
  margin-top:16px;
  color:#f5c542;
}
.detalhamento{
  font-size:.85rem;
  margin-top:12px;
  color:#ddd;
}
.btn{width:100%;margin-top:10px}
</style>
</head>

<body>

<div class="container">

<h2>RF Driver</h2>

<div class="viagem">
ğŸ“Œ Origem: <strong id="origemTxt"></strong><br>
ğŸ›« Destino: <strong id="destinoTxt"></strong>
</div>

<!-- 1ï¸âƒ£ TIPO DE VIAGEM -->
<div class="quadrante">
  <h3>Tipo de viagem</h3>
  <select id="tipoViagem">
    <option value="ida">Ida</option>
    <option value="bate_volta">Bate e volta (Viagem RÃ¡pida)</option>
    <option value="ida_volta">Ida e volta c/ menos de 1h de espera</option>
    <option value="ida_volta_espera">Ida e volta a partir de 1h de espera</option>
  </select>
</div>

<!-- 2ï¸âƒ£ TAXAS -->
<div class="quadrante">
  <label><input type="checkbox" id="excessoPessoas"> Excesso de pessoas</label><br>
  <label><input type="checkbox" id="voltaPraia"> Volta das praias</label><br>
  <label><input type="checkbox" id="desvioSimples"> Desvio de rota simples</label>
</div>

<!-- 3ï¸âƒ£ ANIMAL -->
<div class="quadrante">
  <h3>Transporte de animal</h3>
  <select id="animal">
    <option value="0">Nenhum</option>
    <option value="5">Pequeno</option>
    <option value="7">MÃ©dio</option>
    <option value="10">Grande</option>
    <option value="20">Viagem longa</option>
  </select>
</div>

<!-- 4ï¸âƒ£ DESVIO COM ESPERA -->
<div class="quadrante">
  <h3>Desvio de rota com espera</h3>
  <input type="number" id="minutosEspera" min="0" placeholder="Minutos de espera">
</div>

<!-- DETALHAMENTO -->
<div class="detalhamento" id="detalhamento"></div>

<!-- TOTAL -->
<div class="total" id="total">R$ 0,00</div>

<button class="btn btn-primary" onclick="enviarWhats()">ğŸ“¤ Enviar no WhatsApp</button>

</div>

<script src="core/global.js"></script>

<script>
const origem = App.get("origem");
const destino = App.get("destino");
document.getElementById("origemTxt").innerText = origem;
document.getElementById("destinoTxt").innerText = destino;

const valorBaseOriginal = Number(App.get("valorBase") || 0);

function calcular(){
  let total = valorBaseOriginal;
  let detalhes = [];

  // âœ… VIAGEM BASE (SEMPRE)
  detalhes.push(`ğŸš• Viagem: R$ ${valorBaseOriginal.toFixed(2)}`);

  const tipo = tipoViagem.value;
  if(tipo==="bate_volta"){ total*=1.8; detalhes.push("ğŸ” Bate e volta"); }
  if(tipo==="ida_volta"){ total*=2; detalhes.push("ğŸ” Ida e volta"); }
  if(tipo==="ida_volta_espera"){ total=(total*2)*1.1; detalhes.push("â³ Ida e volta com espera"); }

  if(excessoPessoas.checked){
    const taxa = total < 30 ? 5 : total*0.5;
    total+=taxa;
    detalhes.push(`ğŸ‘¥ Excesso de pessoas: R$ ${taxa.toFixed(2)}`);
  }

  if(voltaPraia.checked){
    total+=10;
    detalhes.push("â›±ï¸ Volta das praias: R$ 10.00");
  }

  if(desvioSimples.checked){
    total+=5;
    detalhes.push("ğŸ›£ï¸ Desvio de rota simples: R$ 5.00");
  }

  const h=new Date().getHours(), m=new Date().getMinutes();
  if(h>22||(h===22&&m>=30)||h<5){
    const taxa = total < 30 ? 5 : total*0.35;
    total+=taxa;
    detalhes.push(`ğŸŒ™ Adicional noturno: R$ ${taxa.toFixed(2)}`);
  }

  const animal=Number(animalSel.value);
  if(animal>0){
    total+=animal;
    detalhes.push(`ğŸ¶ Transporte de animal: R$ ${animal.toFixed(2)}`);
  }

  const min=Number(minutosEspera.value||0);
  if(min>=5){
    const taxa=Math.floor(min/5)*3;
    total+=taxa;
    detalhes.push(`ğŸ›£ï¸â³ Espera (${min}min): R$ ${taxa.toFixed(2)}`);
  }

  App.set("total", total);
  totalDiv.innerText=`R$ ${total.toFixed(2)}`;
  detalheDiv.innerHTML=detalhes.join("<br>");
}

const tipoViagem=document.getElementById("tipoViagem");
const excessoPessoas=document.getElementById("excessoPessoas");
const voltaPraia=document.getElementById("voltaPraia");
const desvioSimples=document.getElementById("desvioSimples");
const animalSel=document.getElementById("animal");
const minutosEspera=document.getElementById("minutosEspera");
const totalDiv=document.getElementById("total");
const detalheDiv=document.getElementById("detalhamento");

document.querySelectorAll("select,input").forEach(e=>e.addEventListener("change",calcular));
calcular();

function enviarWhats(){
  const msg =
`ğŸš– *OrÃ§amento RF Driver*

ğŸ“Œ Origem: ${origem}
ğŸ›« Destino: ${destino}

âœğŸ½ *Detalhamento*
${detalheDiv.innerText}

ğŸ’¸ *Total*: R$ ${App.get("total").toFixed(2)}`;

  window.open("https://wa.me/?text="+encodeURIComponent(msg),"_blank");
}
</script>

</body>
</html>
