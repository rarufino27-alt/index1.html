<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo â€“ RF Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="theme/theme.css">
<link rel="stylesheet" href="theme/layout.css">
<link rel="stylesheet" href="theme/components.css">

<style>
body{
  min-height:100vh;
  background:radial-gradient(circle at top, #1a1a1a 0%, #000 60%);
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.container{
  width:100%;
  max-width:620px;
  padding:30px;
  background:linear-gradient(145deg, rgba(20,20,20,.95), rgba(0,0,0,.85));
  border-radius:22px;
  box-shadow:0 0 40px rgba(255,215,120,.25);
}
h2{
  text-align:center;
  margin-bottom:20px;
  background:linear-gradient(90deg,#d4af37,#f5e28c,#c9a227);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.quadrante{
  border:1px solid rgba(255,215,120,.25);
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
}
.quadrante h3{
  font-size:.95rem;
  margin-bottom:8px;
  color:#f5c542;
}
select,input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  background:#111;
  color:#fff;
}
label{font-size:.85rem}
.total{
  text-align:center;
  font-size:1.4rem;
  margin-top:16px;
  color:#f5c542;
}
.detalhamento{
  font-size:.85rem;
  margin-top:10px;
  color:#ddd;
}
.btn{width:100%;margin-top:10px}
</style>
</head>

<body>

<div class="container">

<h2>Resumo da Corrida</h2>

<!-- 1ï¸âƒ£ TIPO DE VIAGEM -->
<div class="quadrante">
  <h3>Tipo de viagem</h3>
  <select id="tipoViagem">
    <option value="ida">Ida</option>
    <option value="bate_volta">Bate e volta</option>
    <option value="ida_volta">Ida e volta</option>
    <option value="ida_volta_espera">Ida e volta com espera</option>
  </select>
</div>

<!-- 2ï¸âƒ£ EXCESSO DE PESSOAS -->
<div class="quadrante">
  <label>
    <input type="checkbox" id="excessoPessoas"> Excesso de pessoas
  </label>
</div>

<!-- 3ï¸âƒ£ ANIMAL -->
<div class="quadrante">
  <h3>Transporte de animal</h3>
  <select id="animal">
    <option value="0">Nenhum</option>
    <option value="5">Pequeno</option>
    <option value="7">MÃ©dio</option>
    <option value="10">Grande</option>
    <option value="20">Viagem longa</option>
  </select>
</div>

<!-- 4ï¸âƒ£ DESVIO COM ESPERA -->
<div class="quadrante">
  <h3>Desvio de rota com espera</h3>
  <input type="number" id="minutosEspera" min="0" placeholder="Minutos de espera">
</div>

<!-- DETALHAMENTO -->
<div class="detalhamento" id="detalhamento"></div>

<!-- TOTAL -->
<div class="total" id="total">R$ 0,00</div>

<button class="btn btn-primary" onclick="enviarWhats()">ğŸ“¤ Enviar no WhatsApp</button>

</div>

<script src="core/global.js"></script>

<script>
const valorBaseOriginal = Number(App.get("valorBase") || 0);

function calcular(){
  let total = valorBaseOriginal;
  let detalhes = [];

  // 1ï¸âƒ£ Tipo de viagem
  const tipo = document.getElementById("tipoViagem").value;
  if(tipo==="bate_volta"){ total*=2; detalhes.push("ğŸ” Bate e volta"); }
  if(tipo==="ida_volta"){ total*=1.8; detalhes.push("ğŸ” Ida e volta"); }
  if(tipo==="ida_volta_espera"){ total = (total*2)*1.1; detalhes.push("â³ Ida e volta com espera"); }

  // 2ï¸âƒ£ Excesso de pessoas
  if(document.getElementById("excessoPessoas").checked){
    const taxa = total < 30 ? 5 : total*0.5;
    total+=taxa;
    detalhes.push(`ğŸ‘¥ Excesso de pessoas: R$ ${taxa.toFixed(2)}`);
  }

  // 3ï¸âƒ£ Adicional noturno (automÃ¡tico)
  const h = new Date().getHours();
  const m = new Date().getMinutes();
  const noturno = (h>22 || (h===22 && m>=30) || h<5);
  if(noturno){
    const taxa = total < 30 ? 5 : total*0.35;
    total+=taxa;
    detalhes.push(`ğŸŒ™ Adicional noturno: R$ ${taxa.toFixed(2)}`);
  }

  // 4ï¸âƒ£ Animal
  const animal = Number(document.getElementById("animal").value);
  if(animal>0){
    total+=animal;
    detalhes.push(`ğŸ¶ Transporte de animal: R$ ${animal.toFixed(2)}`);
  }

  // 5ï¸âƒ£ Espera
  const min = Number(document.getElementById("minutosEspera").value||0);
  if(min>=5){
    const blocos = Math.floor(min/5);
    const taxa = blocos*3;
    total+=taxa;
    detalhes.push(`ğŸ›£ï¸â³ Espera (${min}min): R$ ${taxa.toFixed(2)}`);
  }

  App.set("total", total);

  document.getElementById("total").innerText = `R$ ${total.toFixed(2)}`;
  document.getElementById("detalhamento").innerHTML = detalhes.join("<br>");
}

document.querySelectorAll("select,input").forEach(e=>e.addEventListener("change",calcular));
calcular();

function enviarWhats(){
  const msg =
`ğŸš– *RF Driver*

ğŸ“Œ Origem: ${App.get("origem")}
ğŸ›« Destino: ${App.get("destino")}
ğŸ’° *Total*: R$ ${App.get("total").toFixed(2)}

âœğŸ½ *Detalhamento*
${document.getElementById("detalhamento").innerText}

ğŸ’¸ *Total*: R$ ${App.get("total").toFixed(2)}`;

  window.open("https://wa.me/?text="+encodeURIComponent(msg),"_blank");
}
</script>

</body>
</html>