<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Resumo da Corrida â€“ RF Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="./theme/theme.css">
<link rel="stylesheet" href="./theme/layout.css">
<link rel="stylesheet" href="./theme/components.css">

<style>
body{
  background:linear-gradient(180deg,#fafafa,#f1f1f1);
  color:#222;
}
.page{
  min-height:100vh;
  display:flex;
  justify-content:center;
  padding:18px;
}
.container{
  width:100%;
  max-width:420px;
  display:flex;
  flex-direction:column;
  gap:16px;
}
.header{
  text-align:center;
  padding:20px;
  border-radius:22px;
  background:#fff;
  box-shadow:0 8px 24px rgba(0,0,0,.08);
}
.header h1{
  font-size:1.15rem;
  color:#d4af37;
  font-weight:800;
}
.route,.block,.totalBox{
  background:#fff;
  border-radius:20px;
  padding:16px;
  box-shadow:0 6px 18px rgba(0,0,0,.06);
}
.route{text-align:center}
label{font-weight:700;font-size:.8rem}
select,input{
  width:100%;
  padding:12px;
  border-radius:14px;
  border:1px solid #ccc;
}
.option{
  display:flex;
  justify-content:space-between;
  padding:12px;
  border:1px solid #eee;
  border-radius:14px;
}
.details div{
  display:flex;
  justify-content:space-between;
  margin-bottom:6px;
}
.totalBox{
  background:#000;
  color:#d4af37;
  text-align:center;
}
.total{
  font-size:2.4rem;
  font-weight:900;
}
.btn{
  padding:16px;
  border-radius:18px;
  background:linear-gradient(180deg,#e6c97a,#d4af37);
  border:none;
  font-weight:800;
}
</style>
</head>

<body>
<div class="page">
<div class="container">

<div class="header">
  <h1>RF Driver â€“ OrÃ§amento de viagem</h1>
</div>

<div class="route">
  <strong>ğŸ“Œ Origem</strong><br><span id="origemTxt"></span>
  <div style="margin:8px 0">â¬‡</div>
  <strong>ğŸ Destino</strong><br><span id="destinoTxt"></span>
</div>

<div class="block">
  <label>ğŸš– Tipo de viagem</label>
  <!-- ğŸ”‘ VALUES CORRIGIDOS -->
  <select id="tipoViagem">
    <option value="ida">ğŸš• Ida</option>
    <option value="bateVolta">â™»ï¸ Bate e volta</option>
    <option value="idaVolta">ğŸš•â™»ï¸ Ida e volta (atÃ© 1h)</option>
    <option value="idaVoltaEspera">ğŸš•â™»ï¸ Ida e volta (a partir de 1h)</option>
  </select>
</div>

<div class="block">
  <div class="option">ğŸ›£ï¸ Desvio simples <input type="checkbox" id="desvioSimples"></div>
  <div class="option">ğŸ–ï¸ Volta da praia <input type="checkbox" id="voltaPraia"></div>
  <div class="option">ğŸ§º Taxa de feira <input type="checkbox" id="taxaFeira"></div>
</div>

<div class="block">
  <label>ğŸ¶ Transporte de animal</label>
  <select id="animal">
    <option value="0">NÃ£o</option>
    <option value="5">Pequeno â€“ R$ 5</option>
    <option value="7">MÃ©dio â€“ R$ 7</option>
    <option value="10">Grande â€“ R$ 10</option>
    <option value="20">Viagem longa â€“ R$ 20</option>
  </select>
</div>

<div class="block">
  <label>â±ï¸ Tempo de espera (min)</label>
  <input type="number" id="minutosEspera">
</div>

<div class="block">
  <strong>Detalhamento</strong>
  <div class="details" id="detalhamento"></div>
</div>

<div class="totalBox">
  <div class="total" id="total">R$ 0,00</div>
</div>

<button class="btn" onclick="enviarWhats()">ğŸ“² Enviar no WhatsApp</button>

</div>
</div>

<script src="core/global.js"></script>
<script src="core/taxas.js"></script>
<script src="core/dinamico.js"></script>

<script>
const origem = App.get("origem");
const destino = App.get("destino");
const valorBase = Number(App.get("valorBase")||0);

origemTxt.innerText = origem;
destinoTxt.innerText = destino;

function calcular(){
  let total = valorBase;
  let d = [];

  d.push(["ğŸš– Viagem base", valorBase]);

  if(Dinamico.ativo){
    const t = valorBase * (Dinamico.multiplicador - 1);
    total += t;
    d.push(["âš¡ Tarifa dinÃ¢mica", t]);
  }

  const tv = tipoViagem.value;
  if(tv !== "ida"){
    const t = valorBase * Taxas.tipoViagem[tv];
    total += t;
    d.push(["â™»ï¸ Tipo de viagem", t]);
  }

  if(desvioSimples.checked){ total+=5; d.push(["ğŸ›£ï¸ Desvio simples",5]); }
  if(voltaPraia.checked){ total+=10; d.push(["ğŸ–ï¸ Volta da praia",10]); }
  if(taxaFeira.checked){ total+=5; d.push(["ğŸ§º Taxa de feira",5]); }

  const a = Number(animal.value||0);
  if(a){ total+=a; d.push(["ğŸ¶ Transporte animal",a]); }

  const m = Number(minutosEspera.value||0);
  if(m>=5){
    const t = Math.floor(m/5)*3;
    total+=t;
    d.push([`â±ï¸ Espera (${m} min)`,t]);
  }

  detalhamento.innerHTML = d.map(x=>`<div><strong>${x[0]}</strong><span>R$ ${x[1].toFixed(2)}</span></div>`).join("");
  totalDiv.innerText = `R$ ${total.toFixed(2)}`;
  App.set("total", total);
}

document.querySelectorAll("select,input").forEach(e=>e.addEventListener("change",calcular));
calcular();

function enviarWhats(){
  window.open("https://wa.me/?text="+encodeURIComponent(
    `ğŸš– *RF Driver â€“ OrÃ§amento*\n\nğŸ“Œ Origem: ${origem}\nğŸ Destino: ${destino}\n\nğŸ’° Total: R$ ${App.get("total").toFixed(2)}`
  ));
}
</script>
</body>
</html>